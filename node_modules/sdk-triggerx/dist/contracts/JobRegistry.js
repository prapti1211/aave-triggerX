"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createJobOnChain = createJobOnChain;
exports.deleteJobOnChain = deleteJobOnChain;
const ethers_1 = require("ethers");
async function createJobOnChain({ jobTitle, jobType, timeFrame, targetContractAddress, encodedData, contractAddress, abi, signer, }) {
    const contract = new ethers_1.ethers.Contract(contractAddress, abi, signer);
    const tx = await contract.createJob(jobTitle, jobType, timeFrame, targetContractAddress, encodedData);
    const receipt = await tx.wait();
    // Try to extract jobId from event logs (assume event is JobCreated(jobId,...))
    const event = receipt.logs
        .map((log) => {
        try {
            return contract.interface.parseLog(log);
        }
        catch {
            return null;
        }
    })
        .find((e) => e && e.name === 'JobCreated');
    if (event && event.args && event.args[0]) {
        return event.args[0].toString();
    }
    throw new Error('Job ID not found in contract events');
}
async function deleteJobOnChain({ jobId, contractAddress, abi, signer, }) {
    const contract = new ethers_1.ethers.Contract(contractAddress, abi.abi, signer);
    const tx = await contract.deleteJob(jobId);
    await tx.wait();
}
